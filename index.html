<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en,zh-tw,default">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="always belive that something wonderful is about to happen">
<meta property="og:type" content="website">
<meta property="og:title" content="blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="blog">
<meta property="og:description" content="always belive that something wonderful is about to happen">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="blog">
<meta name="twitter:description" content="always belive that something wonderful is about to happen">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">student's blogs</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tag" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            Commonweal 404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/19/web服务器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cedar Chen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/19/web服务器/" itemprop="url">web服务器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-19T15:10:13+08:00">
                2019-03-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h1><h2 id="匹配单个字符"><a href="#匹配单个字符" class="headerlink" title="匹配单个字符"></a>匹配单个字符</h2><p>点.匹配任意一个字符<br>[ ]    匹配[ ]中列举的字符<br>\d    匹配数字，即0-9<br>\D    匹配非数字，即不是数字<br>\s    匹配空白，即空格，tab键<br>\S    匹配非空白<br>\w    匹配单词字符，即a-z、A-Z、0-9、_<br>\W    匹配非单词字符</p>
<h2 id="匹配多个字符"><a href="#匹配多个字符" class="headerlink" title="匹配多个字符*"></a>匹配多个字符*</h2><p>星号*匹配前一个字符出现0次或无限次，即可有可无<br>加号+    匹配前一个字符出现1次或无限次，即至少有一次<br>？    匹配前一个字符出现一次或者0次，即要么没有要么一次<br>{m}    匹配前一个字符出现m次<br>{m,n}    匹配前一个字符出现m到n次</p>
<h2 id="匹配开头结尾"><a href="#匹配开头结尾" class="headerlink" title="匹配开头结尾"></a>匹配开头结尾</h2><p>^    匹配字符开头<br>$    匹配字符结尾</p>
<h2 id="匹配分组"><a href="#匹配分组" class="headerlink" title="匹配分组"></a>匹配分组</h2><p>|    匹配左右任意一个表达式<br>(ab)    将括号中字符作为一个组<br>\num    引用分组num匹配到字符串<br>(?p<name>)    分区起别名<br>(?p=name&gt;)    引用别名为name分组匹配到的字符串</name></p>
<h1 id="简单的web服务器的实现"><a href="#简单的web服务器的实现" class="headerlink" title="简单的web服务器的实现"></a>简单的web服务器的实现</h1><h2 id="tcp三次握手、四次挥手"><a href="#tcp三次握手、四次挥手" class="headerlink" title="tcp三次握手、四次挥手"></a>tcp三次握手、四次挥手</h2><h3 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h3><p>所谓三次握手(Three-way Handshake)，是指建立一个 TCP 连接时，需要客户端和服务器总共发送3个包。</p>
<p>三次握手的目的是连接服务器指定端口，建立 TCP 连接，并同步连接双方的序列号和确认号，交换 TCP 窗口大小信息。在 socket 编程中，客户端执行 connect() 时。将触发三次握手。</p>
<p>第一次握手(SYN=1, seq=x):</p>
<p>客户端发送一个 TCP 的 SYN 标志位置1的包，指明客户端打算连接的服务器的端口，以及初始序号 X,保存在包头的序列号(Sequence Number)字段里。</p>
<p>发送完毕后，客户端进入 SYN_SEND 状态。</p>
<p>第二次握手(SYN=1, ACK=1, seq=y, ACKnum=x+1):</p>
<p>服务器发回确认包(ACK)应答。即 SYN 标志位和 ACK 标志位均为1。服务器端选择自己 ISN 序列号，放到 Seq 域里，同时将确认序号(Acknowledgement Number)设置为客户的 ISN 加1，即X+1。 发送完毕后，服务器端进入 SYN_RCVD 状态。</p>
<p>第三次握手(ACK=1，ACKnum=y+1)</p>
<p>客户端再次发送确认包(ACK)，SYN 标志位为0，ACK 标志位为1，并且把服务器发来 ACK 的序号字段+1，放在确定字段中发送给对方，并且在数据段放写ISN的+1</p>
<p>发送完毕后，客户端进入 ESTABLISHED 状态，当服务器端接收到这个包时，也进入 ESTABLISHED 状态，TCP 握手结束。</p>
<h3 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a>四次挥手</h3><p>TCP 的连接的拆除需要发送四个包，因此称为四次挥手(Four-way handshake)，也叫做改进的三次握手。客户端或服务器均可主动发起挥手动作，在 socket 编程中，任何一方执行 close() 操作即可产生挥手操作。</p>
<p>第一次挥手(FIN=1，seq=x)</p>
<p>假设客户端想要关闭连接，客户端发送一个 FIN 标志位置为1的包，表示自己已经没有数据可以发送了，但是仍然可以接受数据。</p>
<p>发送完毕后，客户端进入 FIN_WAIT_1 状态。</p>
<p>第二次挥手(ACK=1，ACKnum=x+1)</p>
<p>服务器端确认客户端的 FIN 包，发送一个确认包，表明自己接受到了客户端关闭连接的请求，但还没有准备好关闭连接。</p>
<p>发送完毕后，服务器端进入 CLOSE_WAIT 状态，客户端接收到这个确认包之后，进入 FIN_WAIT_2 状态，等待服务器端关闭连接。</p>
<p>第三次挥手(FIN=1，seq=y)</p>
<p>服务器端准备好关闭连接时，向客户端发送结束连接请求，FIN 置为1。</p>
<p>发送完毕后，服务器端进入 LAST_ACK 状态，等待来自客户端的最后一个ACK。</p>
<p>第四次挥手(ACK=1，ACKnum=y+1)</p>
<p>客户端接收到来自服务器端的关闭请求，发送一个确认包，并进入 TIME_WAIT状态，等待可能出现的要求重传的 ACK 包。</p>
<p>服务器端接收到这个确认包之后，关闭连接，进入 CLOSED 状态。</p>
<p>客户端等待了某个固定时间（两个最大段生命周期，2MSL，2 Maximum Segment Lifetime）之后，没有收到服务器端的 ACK ，认为服务器端已经正常关闭连接，于是自己也关闭连接，进入 CLOSED 状态。</p>
<h1 id="并发web服务器实现"><a href="#并发web服务器实现" class="headerlink" title="并发web服务器实现"></a>并发web服务器实现</h1><h2 id="根据用户的需求返回相应的页面"><a href="#根据用户的需求返回相应的页面" class="headerlink" title="根据用户的需求返回相应的页面"></a>根据用户的需求返回相应的页面</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">service_client</span><span class="params">(new_socket)</span>:</span></span><br><span class="line">    <span class="string">"""为这个客户端返回数据"""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 接收浏览器发送过来的请求 ，即http请求  </span></span><br><span class="line">    <span class="comment"># GET / HTTP/1.1</span></span><br><span class="line">    <span class="comment"># .....</span></span><br><span class="line">    request = new_socket.recv(<span class="number">1024</span>).decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    <span class="comment"># print("&gt;&gt;&gt;"*50)</span></span><br><span class="line">    <span class="comment"># print(request)</span></span><br><span class="line"></span><br><span class="line">    request_lines = request.splitlines()</span><br><span class="line">    print(<span class="string">""</span>)</span><br><span class="line">    print(<span class="string">"&gt;"</span>*<span class="number">20</span>)</span><br><span class="line">    print(request_lines)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># GET /index.html HTTP/1.1</span></span><br><span class="line">    <span class="comment"># get post put del</span></span><br><span class="line">    file_name = <span class="string">""</span></span><br><span class="line">    ret = re.match(<span class="string">r"[^/]+(/[^ ]*)"</span>, request_lines[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> ret:</span><br><span class="line">        file_name = ret.group(<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># print("*"*50, file_name)</span></span><br><span class="line">        <span class="keyword">if</span> file_name == <span class="string">"/"</span>:</span><br><span class="line">            file_name = <span class="string">"/index.html"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 返回http格式的数据，给浏览器</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f = open(<span class="string">"./html"</span> + file_name, <span class="string">"rb"</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        response = <span class="string">"HTTP/1.1 404 NOT FOUND\r\n"</span></span><br><span class="line">        response += <span class="string">"\r\n"</span></span><br><span class="line">        response += <span class="string">"------file not found-----"</span></span><br><span class="line">        new_socket.send(response.encode(<span class="string">"utf-8"</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        html_content = f.read()</span><br><span class="line">        f.close()</span><br><span class="line">        <span class="comment"># 2.1 准备发送给浏览器的数据---header</span></span><br><span class="line">        response = <span class="string">"HTTP/1.1 200 OK\r\n"</span></span><br><span class="line">        response += <span class="string">"\r\n"</span></span><br><span class="line">        <span class="comment"># 2.2 准备发送给浏览器的数据---boy</span></span><br><span class="line">        <span class="comment"># response += "hahahhah"</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将response header发送给浏览器</span></span><br><span class="line">        new_socket.send(response.encode(<span class="string">"utf-8"</span>))</span><br><span class="line">        <span class="comment"># 将response body发送给浏览器</span></span><br><span class="line">        new_socket.send(html_content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭套接</span></span><br><span class="line">    new_socket.close()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""用来完成整体的控制"""</span></span><br><span class="line">    <span class="comment"># 1. 创建套接字</span></span><br><span class="line">    tcp_server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    tcp_server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 绑定</span></span><br><span class="line">    tcp_server_socket.bind((<span class="string">""</span>, <span class="number">7890</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 变为监听套接字</span></span><br><span class="line">    tcp_server_socket.listen(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># 4. 等待新客户端的链接</span></span><br><span class="line">        new_socket, client_addr = tcp_server_socket.accept()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5. 为这个客户端服务</span></span><br><span class="line">        service_client(new_socket)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭监听套接字</span></span><br><span class="line">    tcp_server_socket.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="使用多进程完成http服务器"><a href="#使用多进程完成http服务器" class="headerlink" title="使用多进程完成http服务器"></a>使用多进程完成http服务器</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">service_client</span><span class="params">(new_socket)</span>:</span></span><br><span class="line">    <span class="string">"""为这个客户端返回数据"""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 接收浏览器发送过来的请求 ，即http请求  </span></span><br><span class="line">    <span class="comment"># GET / HTTP/1.1</span></span><br><span class="line">    <span class="comment"># .....</span></span><br><span class="line">    request = new_socket.recv(<span class="number">1024</span>).decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    <span class="comment"># print("&gt;&gt;&gt;"*50)</span></span><br><span class="line">    <span class="comment"># print(request)</span></span><br><span class="line"></span><br><span class="line">    request_lines = request.splitlines()</span><br><span class="line">    print(<span class="string">""</span>)</span><br><span class="line">    print(<span class="string">"&gt;"</span>*<span class="number">20</span>)</span><br><span class="line">    print(request_lines)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># GET /index.html HTTP/1.1</span></span><br><span class="line">    <span class="comment"># get post put del</span></span><br><span class="line">    file_name = <span class="string">""</span></span><br><span class="line">    ret = re.match(<span class="string">r"[^/]+(/[^ ]*)"</span>, request_lines[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> ret:</span><br><span class="line">        file_name = ret.group(<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># print("*"*50, file_name)</span></span><br><span class="line">        <span class="keyword">if</span> file_name == <span class="string">"/"</span>:</span><br><span class="line">            file_name = <span class="string">"/index.html"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 返回http格式的数据，给浏览器</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f = open(<span class="string">"./html"</span> + file_name, <span class="string">"rb"</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        response = <span class="string">"HTTP/1.1 404 NOT FOUND\r\n"</span></span><br><span class="line">        response += <span class="string">"\r\n"</span></span><br><span class="line">        response += <span class="string">"------file not found-----"</span></span><br><span class="line">        new_socket.send(response.encode(<span class="string">"utf-8"</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        html_content = f.read()</span><br><span class="line">        f.close()</span><br><span class="line">        <span class="comment"># 2.1 准备发送给浏览器的数据---header</span></span><br><span class="line">        response = <span class="string">"HTTP/1.1 200 OK\r\n"</span></span><br><span class="line">        response += <span class="string">"\r\n"</span></span><br><span class="line">        <span class="comment"># 2.2 准备发送给浏览器的数据---boy</span></span><br><span class="line">        <span class="comment"># response += "hahahhah"</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将response header发送给浏览器</span></span><br><span class="line">        new_socket.send(response.encode(<span class="string">"utf-8"</span>))</span><br><span class="line">        <span class="comment"># 将response body发送给浏览器</span></span><br><span class="line">        new_socket.send(html_content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭套接</span></span><br><span class="line">    new_socket.close()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""用来完成整体的控制"""</span></span><br><span class="line">    <span class="comment"># 1. 创建套接字</span></span><br><span class="line">    tcp_server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    tcp_server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 绑定</span></span><br><span class="line">    tcp_server_socket.bind((<span class="string">""</span>, <span class="number">7890</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 变为监听套接字</span></span><br><span class="line">    tcp_server_socket.listen(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># 4. 等待新客户端的链接</span></span><br><span class="line">        new_socket, client_addr = tcp_server_socket.accept()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5. 为这个客户端服务</span></span><br><span class="line">        p = multiprocessing.Process(target=service_client, args=(new_socket,))</span><br><span class="line">        p.start()</span><br><span class="line"></span><br><span class="line">        new_socket.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭监听套接字</span></span><br><span class="line">    tcp_server_socket.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="使用多线程来完成http服务器"><a href="#使用多线程来完成http服务器" class="headerlink" title="使用多线程来完成http服务器"></a>使用多线程来完成http服务器</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">service_client</span><span class="params">(new_socket)</span>:</span></span><br><span class="line">    <span class="string">"""为这个客户端返回数据"""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 接收浏览器发送过来的请求 ，即http请求  </span></span><br><span class="line">    <span class="comment"># GET / HTTP/1.1</span></span><br><span class="line">    <span class="comment"># .....</span></span><br><span class="line">    request = new_socket.recv(<span class="number">1024</span>).decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    <span class="comment"># print("&gt;&gt;&gt;"*50)</span></span><br><span class="line">    <span class="comment"># print(request)</span></span><br><span class="line"></span><br><span class="line">    request_lines = request.splitlines()</span><br><span class="line">    print(<span class="string">""</span>)</span><br><span class="line">    print(<span class="string">"&gt;"</span>*<span class="number">20</span>)</span><br><span class="line">    print(request_lines)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># GET /index.html HTTP/1.1</span></span><br><span class="line">    <span class="comment"># get post put del</span></span><br><span class="line">    file_name = <span class="string">""</span></span><br><span class="line">    ret = re.match(<span class="string">r"[^/]+(/[^ ]*)"</span>, request_lines[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> ret:</span><br><span class="line">        file_name = ret.group(<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># print("*"*50, file_name)</span></span><br><span class="line">        <span class="keyword">if</span> file_name == <span class="string">"/"</span>:</span><br><span class="line">            file_name = <span class="string">"/index.html"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 返回http格式的数据，给浏览器</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f = open(<span class="string">"./html"</span> + file_name, <span class="string">"rb"</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        response = <span class="string">"HTTP/1.1 404 NOT FOUND\r\n"</span></span><br><span class="line">        response += <span class="string">"\r\n"</span></span><br><span class="line">        response += <span class="string">"------file not found-----"</span></span><br><span class="line">        new_socket.send(response.encode(<span class="string">"utf-8"</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        html_content = f.read()</span><br><span class="line">        f.close()</span><br><span class="line">        <span class="comment"># 2.1 准备发送给浏览器的数据---header</span></span><br><span class="line">        response = <span class="string">"HTTP/1.1 200 OK\r\n"</span></span><br><span class="line">        response += <span class="string">"\r\n"</span></span><br><span class="line">        <span class="comment"># 2.2 准备发送给浏览器的数据---boy</span></span><br><span class="line">        <span class="comment"># response += "hahahhah"</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将response header发送给浏览器</span></span><br><span class="line">        new_socket.send(response.encode(<span class="string">"utf-8"</span>))</span><br><span class="line">        <span class="comment"># 将response body发送给浏览器</span></span><br><span class="line">        new_socket.send(html_content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭套接</span></span><br><span class="line">    new_socket.close()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""用来完成整体的控制"""</span></span><br><span class="line">    <span class="comment"># 1. 创建套接字</span></span><br><span class="line">    tcp_server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    tcp_server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 绑定</span></span><br><span class="line">    tcp_server_socket.bind((<span class="string">""</span>, <span class="number">7890</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 变为监听套接字</span></span><br><span class="line">    tcp_server_socket.listen(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># 4. 等待新客户端的链接</span></span><br><span class="line">        new_socket, client_addr = tcp_server_socket.accept()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5. 为这个客户端服务</span></span><br><span class="line">        p = threading.Thread(target=service_client, args=(new_socket,))</span><br><span class="line">        p.start()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># new_socket.close()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭监听套接字</span></span><br><span class="line">    tcp_server_socket.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="使用gevent来实现http服务器"><a href="#使用gevent来实现http服务器" class="headerlink" title="使用gevent来实现http服务器"></a>使用gevent来实现http服务器</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> gevent</span><br><span class="line"><span class="keyword">from</span> gevent <span class="keyword">import</span> monkey</span><br><span class="line"></span><br><span class="line">monkey.patch_all()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">service_client</span><span class="params">(new_socket)</span>:</span></span><br><span class="line">    <span class="string">"""为这个客户端返回数据"""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 接收浏览器发送过来的请求 ，即http请求  </span></span><br><span class="line">    <span class="comment"># GET / HTTP/1.1</span></span><br><span class="line">    <span class="comment"># .....</span></span><br><span class="line">    request = new_socket.recv(<span class="number">1024</span>).decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    <span class="comment"># print("&gt;&gt;&gt;"*50)</span></span><br><span class="line">    <span class="comment"># print(request)</span></span><br><span class="line"></span><br><span class="line">    request_lines = request.splitlines()</span><br><span class="line">    print(<span class="string">""</span>)</span><br><span class="line">    print(<span class="string">"&gt;"</span>*<span class="number">20</span>)</span><br><span class="line">    print(request_lines)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># GET /index.html HTTP/1.1</span></span><br><span class="line">    <span class="comment"># get post put del</span></span><br><span class="line">    file_name = <span class="string">""</span></span><br><span class="line">    ret = re.match(<span class="string">r"[^/]+(/[^ ]*)"</span>, request_lines[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> ret:</span><br><span class="line">        file_name = ret.group(<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># print("*"*50, file_name)</span></span><br><span class="line">        <span class="keyword">if</span> file_name == <span class="string">"/"</span>:</span><br><span class="line">            file_name = <span class="string">"/index.html"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 返回http格式的数据，给浏览器</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f = open(<span class="string">"./html"</span> + file_name, <span class="string">"rb"</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        response = <span class="string">"HTTP/1.1 404 NOT FOUND\r\n"</span></span><br><span class="line">        response += <span class="string">"\r\n"</span></span><br><span class="line">        response += <span class="string">"------file not found-----"</span></span><br><span class="line">        new_socket.send(response.encode(<span class="string">"utf-8"</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        html_content = f.read()</span><br><span class="line">        f.close()</span><br><span class="line">        <span class="comment"># 2.1 准备发送给浏览器的数据---header</span></span><br><span class="line">        response = <span class="string">"HTTP/1.1 200 OK\r\n"</span></span><br><span class="line">        response += <span class="string">"\r\n"</span></span><br><span class="line">        <span class="comment"># 2.2 准备发送给浏览器的数据---boy</span></span><br><span class="line">        <span class="comment"># response += "hahahhah"</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将response header发送给浏览器</span></span><br><span class="line">        new_socket.send(response.encode(<span class="string">"utf-8"</span>))</span><br><span class="line">        <span class="comment"># 将response body发送给浏览器</span></span><br><span class="line">        new_socket.send(html_content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭套接</span></span><br><span class="line">    new_socket.close()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""用来完成整体的控制"""</span></span><br><span class="line">    <span class="comment"># 1. 创建套接字</span></span><br><span class="line">    tcp_server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    tcp_server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 绑定</span></span><br><span class="line">    tcp_server_socket.bind((<span class="string">""</span>, <span class="number">7890</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 变为监听套接字</span></span><br><span class="line">    tcp_server_socket.listen(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># 4. 等待新客户端的链接</span></span><br><span class="line">        new_socket, client_addr = tcp_server_socket.accept()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5. 为这个客户端服务</span></span><br><span class="line">        gevent.spawn(service_client, new_socket)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># new_socket.close()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭监听套接字</span></span><br><span class="line">    tcp_server_socket.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="单进程-单线程-非堵塞"><a href="#单进程-单线程-非堵塞" class="headerlink" title="单进程-单线程-非堵塞"></a>单进程-单线程-非堵塞</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">tcp_server_tcp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">tcp_server_tcp.bind((<span class="string">""</span>, <span class="number">7899</span>))</span><br><span class="line">tcp_server_tcp.listen(<span class="number">128</span>)</span><br><span class="line">tcp_server_tcp.setblocking(<span class="literal">False</span>)  <span class="comment"># 设置套接字为非堵塞的方式</span></span><br><span class="line"></span><br><span class="line">client_socket_list = list()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># time.sleep(0.5)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        new_socket, new_addr = tcp_server_tcp.accept()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ret:</span><br><span class="line">        print(<span class="string">"---没有新的客户端到来---"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"---只要没有产生异常，那么也就意味着 来了一个新的客户端----"</span>)</span><br><span class="line">        new_socket.setblocking(<span class="literal">False</span>)  <span class="comment"># 设置套接字为非堵塞的方式</span></span><br><span class="line">        client_socket_list.append(new_socket)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> client_socket <span class="keyword">in</span> client_socket_list:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            recv_data = client_socket.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> ret:</span><br><span class="line">            print(ret)</span><br><span class="line">            print(<span class="string">"----这个客户端没有发送过来数据----"</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"-----没有异常-----"</span>)</span><br><span class="line">            print(recv_data)</span><br><span class="line">            <span class="keyword">if</span> recv_data:</span><br><span class="line">                <span class="comment"># 对方发送过来数据</span></span><br><span class="line">                print(<span class="string">"----客户端发送过来了数据-----"</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 对方调用close 导致了 recv返回</span></span><br><span class="line">                client_socket.close()</span><br><span class="line">                client_socket_list.remove(client_socket)</span><br><span class="line">                print(<span class="string">"---客户端已经关闭----"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="进程-单线程-非堵塞-长链接"><a href="#进程-单线程-非堵塞-长链接" class="headerlink" title="进程-单线程-非堵塞-长链接"></a>进程-单线程-非堵塞-长链接</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">service_client</span><span class="params">(new_socket, request)</span>:</span></span><br><span class="line">    <span class="string">"""为这个客户端返回数据"""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 接收浏览器发送过来的请求 ，即http请求  </span></span><br><span class="line">    <span class="comment"># GET / HTTP/1.1</span></span><br><span class="line">    <span class="comment"># .....</span></span><br><span class="line">    <span class="comment"># request = new_socket.recv(1024).decode("utf-8")</span></span><br><span class="line">    <span class="comment"># print("&gt;&gt;&gt;"*50)</span></span><br><span class="line">    <span class="comment"># print(request)</span></span><br><span class="line"></span><br><span class="line">    request_lines = request.splitlines()</span><br><span class="line">    print(<span class="string">""</span>)</span><br><span class="line">    print(<span class="string">"&gt;"</span>*<span class="number">20</span>)</span><br><span class="line">    print(request_lines)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># GET /index.html HTTP/1.1</span></span><br><span class="line">    <span class="comment"># get post put del</span></span><br><span class="line">    file_name = <span class="string">""</span></span><br><span class="line">    ret = re.match(<span class="string">r"[^/]+(/[^ ]*)"</span>, request_lines[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> ret:</span><br><span class="line">        file_name = ret.group(<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># print("*"*50, file_name)</span></span><br><span class="line">        <span class="keyword">if</span> file_name == <span class="string">"/"</span>:</span><br><span class="line">            file_name = <span class="string">"/index.html"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 返回http格式的数据，给浏览器</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f = open(<span class="string">"./html"</span> + file_name, <span class="string">"rb"</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        response = <span class="string">"HTTP/1.1 404 NOT FOUND\r\n"</span></span><br><span class="line">        response += <span class="string">"\r\n"</span></span><br><span class="line">        response += <span class="string">"------file not found-----"</span></span><br><span class="line">        new_socket.send(response.encode(<span class="string">"utf-8"</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        html_content = f.read()</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line">        response_body = html_content</span><br><span class="line"></span><br><span class="line">        response_header = <span class="string">"HTTP/1.1 200 OK\r\n"</span></span><br><span class="line">        response_header += <span class="string">"Content-Length:%d\r\n"</span> % len(response_body)</span><br><span class="line">        response_header += <span class="string">"\r\n"</span></span><br><span class="line"></span><br><span class="line">        response = response_header.encode(<span class="string">"utf-8"</span>) + response_body</span><br><span class="line"></span><br><span class="line">        new_socket.send(response)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""用来完成整体的控制"""</span></span><br><span class="line">    <span class="comment"># 1. 创建套接字</span></span><br><span class="line">    tcp_server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    tcp_server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 绑定</span></span><br><span class="line">    tcp_server_socket.bind((<span class="string">""</span>, <span class="number">7890</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 变为监听套接字</span></span><br><span class="line">    tcp_server_socket.listen(<span class="number">128</span>)</span><br><span class="line">    tcp_server_socket.setblocking(<span class="literal">False</span>)  <span class="comment"># 将套接字变为非堵塞</span></span><br><span class="line"></span><br><span class="line">    client_socket_list = list()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># 4. 等待新客户端的链接</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            new_socket, client_addr = tcp_server_socket.accept()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> ret:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            new_socket.setblocking(<span class="literal">False</span>)</span><br><span class="line">            client_socket_list.append(new_socket)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> client_socket <span class="keyword">in</span> client_socket_list:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                recv_data = client_socket.recv(<span class="number">1024</span>).decode(<span class="string">"utf-8"</span>)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> ret:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> recv_data:</span><br><span class="line">                    service_client(client_socket, recv_data)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    client_socket.close()</span><br><span class="line">                    client_socket_list.remove(client_socket)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭监听套接字</span></span><br><span class="line">    tcp_server_socket.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="epoll实现http"><a href="#epoll实现http" class="headerlink" title="epoll实现http"></a>epoll实现http</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">service_client</span><span class="params">(new_socket, request)</span>:</span></span><br><span class="line">    <span class="string">"""为这个客户端返回数据"""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 接收浏览器发送过来的请求 ，即http请求  </span></span><br><span class="line">    <span class="comment"># GET / HTTP/1.1</span></span><br><span class="line">    <span class="comment"># .....</span></span><br><span class="line">    <span class="comment"># request = new_socket.recv(1024).decode("utf-8")</span></span><br><span class="line">    <span class="comment"># print("&gt;&gt;&gt;"*50)</span></span><br><span class="line">    <span class="comment"># print(request)</span></span><br><span class="line"></span><br><span class="line">    request_lines = request.splitlines()</span><br><span class="line">    print(<span class="string">""</span>)</span><br><span class="line">    print(<span class="string">"&gt;"</span>*<span class="number">20</span>)</span><br><span class="line">    print(request_lines)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># GET /index.html HTTP/1.1</span></span><br><span class="line">    <span class="comment"># get post put del</span></span><br><span class="line">    file_name = <span class="string">""</span></span><br><span class="line">    ret = re.match(<span class="string">r"[^/]+(/[^ ]*)"</span>, request_lines[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> ret:</span><br><span class="line">        file_name = ret.group(<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># print("*"*50, file_name)</span></span><br><span class="line">        <span class="keyword">if</span> file_name == <span class="string">"/"</span>:</span><br><span class="line">            file_name = <span class="string">"/index.html"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 返回http格式的数据，给浏览器</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f = open(<span class="string">"./html"</span> + file_name, <span class="string">"rb"</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        response = <span class="string">"HTTP/1.1 404 NOT FOUND\r\n"</span></span><br><span class="line">        response += <span class="string">"\r\n"</span></span><br><span class="line">        response += <span class="string">"------file not found-----"</span></span><br><span class="line">        new_socket.send(response.encode(<span class="string">"utf-8"</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        html_content = f.read()</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line">        response_body = html_content</span><br><span class="line"></span><br><span class="line">        response_header = <span class="string">"HTTP/1.1 200 OK\r\n"</span></span><br><span class="line">        response_header += <span class="string">"Content-Length:%d\r\n"</span> % len(response_body)</span><br><span class="line">        response_header += <span class="string">"\r\n"</span></span><br><span class="line"></span><br><span class="line">        response = response_header.encode(<span class="string">"utf-8"</span>) + response_body</span><br><span class="line"></span><br><span class="line">        new_socket.send(response)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""用来完成整体的控制"""</span></span><br><span class="line">    <span class="comment"># 1. 创建套接字</span></span><br><span class="line">    tcp_server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    tcp_server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 绑定</span></span><br><span class="line">    tcp_server_socket.bind((<span class="string">""</span>, <span class="number">7890</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 变为监听套接字</span></span><br><span class="line">    tcp_server_socket.listen(<span class="number">128</span>)</span><br><span class="line">    tcp_server_socket.setblocking(<span class="literal">False</span>)  <span class="comment"># 将套接字变为非堵塞</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个epoll对象</span></span><br><span class="line">    epl = select.epoll()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将监听套接字对应的fd注册到epoll中</span></span><br><span class="line">    epl.register(tcp_server_socket.fileno(), select.EPOLLIN)</span><br><span class="line"></span><br><span class="line">    fd_event_dict = dict()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">        fd_event_list = epl.poll()  <span class="comment"># 默认会堵塞，直到 os监测到数据到来 通过事件通知方式 告诉这个程序，此时才会解堵塞</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># [(fd, event), (套接字对应的文件描述符, 这个文件描述符到底是什么事件 例如 可以调用recv接收等)]</span></span><br><span class="line">        <span class="keyword">for</span> fd, event <span class="keyword">in</span> fd_event_list:</span><br><span class="line">            <span class="comment"># 等待新客户端的链接</span></span><br><span class="line">            <span class="keyword">if</span> fd == tcp_server_socket.fileno():</span><br><span class="line">                new_socket, client_addr = tcp_server_socket.accept()</span><br><span class="line">                epl.register(new_socket.fileno(), select.EPOLLIN)</span><br><span class="line">                fd_event_dict[new_socket.fileno()] = new_socket</span><br><span class="line">            <span class="keyword">elif</span> event==select.EPOLLIN:</span><br><span class="line">                <span class="comment"># 判断已经链接的客户端是否有数据发送过来</span></span><br><span class="line">                recv_data = fd_event_dict[fd].recv(<span class="number">1024</span>).decode(<span class="string">"utf-8"</span>)</span><br><span class="line">                <span class="keyword">if</span> recv_data:</span><br><span class="line">                    service_client(fd_event_dict[fd], recv_data)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    fd_event_dict[fd].close()</span><br><span class="line">                    epl.unregister(fd)</span><br><span class="line">                    <span class="keyword">del</span> fd_event_dict[fd]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭监听套接字</span></span><br><span class="line">    tcp_server_socket.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/19/多任务/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cedar Chen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/19/多任务/" itemprop="url">多任务</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-19T15:09:53+08:00">
                2019-03-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h1><p>进程是系统资源分配的最小单位, 系统由一个个进程(程序)组成<br>一般情况下，包括文本区域（text region）、数据区域（data region）和堆栈（stack region）。<br>文本区域存储处理器执行的代码<br>数据区域存储变量和进程执行期间使用的动态分配的内存；<br>堆栈区域存储着活动过程调用的指令和本地变量。</p>
<h1 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h1><p>线程属于进程<br>线程共享进程的内存地址空间<br>线程几乎不占有系统资源<br>通信问题:   进程相当于一个容器,而线程而是运行在容器里面的,因此对于容器内的东西,线程是共同享有的,因此线程间的通信可以直接通过全局变量进行通信,但是由此带来的例如多个线程读写同一个地址变量的时候则将带来不可预期的后果,因此这时候引入了各种锁的作用,例如互斥锁等。</p>
<h2 id="多任务文件夹复制（可以显示进度）"><a href="#多任务文件夹复制（可以显示进度）" class="headerlink" title="多任务文件夹复制（可以显示进度）"></a>多任务文件夹复制（可以显示进度）</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">copy_file</span><span class="params">(q, file_name, old_folder_name, new_folder_name)</span>:</span></span><br><span class="line">    <span class="string">"""完成文件的复制"""</span></span><br><span class="line">    <span class="comment"># print("======&gt;模拟copy文件：从%s---&gt;到%s 文件名是:%s" % (old_folder_name, new_folder_name, file_name))</span></span><br><span class="line">    old_f = open(old_folder_name + <span class="string">"/"</span> + file_name, <span class="string">"rb"</span>)</span><br><span class="line">    content = old_f.read()</span><br><span class="line">    old_f.close()</span><br><span class="line"></span><br><span class="line">    new_f = open(new_folder_name + <span class="string">"/"</span> + file_name, <span class="string">"wb"</span>)</span><br><span class="line">    new_f.write(content)</span><br><span class="line">    new_f.close()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 如果拷贝完了文件，那么就向队列中写入一个消息，表示已经完成</span></span><br><span class="line">    q.put(file_name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 1. 获取用户要copy的文件夹的名字</span></span><br><span class="line">    old_folder_name = input(<span class="string">"请输入要copy的文件夹的名字："</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 创建一个新的文件夹</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        new_folder_name = old_folder_name + <span class="string">"[复件]"</span></span><br><span class="line">        os.mkdir(new_folder_name)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 获取文件夹的所有的待copy的文件名字  listdir()</span></span><br><span class="line">    file_names = os.listdir(old_folder_name)</span><br><span class="line">   <span class="comment"># print(file_names)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4. 创建进程池</span></span><br><span class="line">    po = multiprocessing.Pool(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5. 创建一个队列</span></span><br><span class="line">    q = multiprocessing.Manager().Queue()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 6. 向进程池中添加 copy文件的任务</span></span><br><span class="line">    <span class="keyword">for</span> file_name <span class="keyword">in</span> file_names:</span><br><span class="line">        po.apply_async(copy_file, args=(q, file_name, old_folder_name, new_folder_name))</span><br><span class="line"></span><br><span class="line">    po.close()</span><br><span class="line">    <span class="comment"># po.join()</span></span><br><span class="line">    all_file_num = len(file_names)  <span class="comment"># 测一下所有的文件个数</span></span><br><span class="line">    copy_ok_num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        file_name = q.get()</span><br><span class="line">        <span class="comment"># print("已经完成copy：%s" % file_name)</span></span><br><span class="line">        copy_ok_num+=<span class="number">1</span></span><br><span class="line">        print(<span class="string">"\r拷贝的进度为：%.2f %%"</span> % (copy_ok_num*<span class="number">100</span>/all_file_num), end=<span class="string">""</span>)</span><br><span class="line">        <span class="keyword">if</span> copy_ok_num &gt;= all_file_num:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h1 id="协程"><a href="#协程" class="headerlink" title="协程"></a>协程</h1><p>协程是属于线程的。协程程序是在线程里面跑的，因此协程又称微线程和纤程等<br>协没有线程的上下文切换消耗。协程的调度切换是用户(程序员)手动切换的,因此更加灵活,因此又叫用户空间线程.<br>原子操作性。由于协程是用户调度的，所以不会出现执行一半的代码片段被强制中断了，因此无需原子操作锁。</p>
<h2 id="图片下载器"><a href="#图片下载器" class="headerlink" title="图片下载器"></a>图片下载器</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">import</span> gevent</span><br><span class="line"><span class="keyword">from</span> gevent <span class="keyword">import</span> monkey</span><br><span class="line"></span><br><span class="line">monkey.patch_all()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">downloader</span><span class="params">(img_name, img_url)</span>:</span></span><br><span class="line">    req = urllib.request.urlopen(img_url)</span><br><span class="line"></span><br><span class="line">    img_content = req.read()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> open(img_name, <span class="string">"wb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(img_content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    gevent.joinall([</span><br><span class="line">            gevent.spawn(downloader, <span class="string">"3.jpg"</span>, <span class="string">"https://rpic.douyucdn.cn/appCovers/2017/09/22/1760931_20170922133718_big.jpg"</span>),</span><br><span class="line">            gevent.spawn(downloader, <span class="string">"4.jpg"</span>, <span class="string">"https://rpic.douyucdn.cn/appCovers/2017/09/17/2308890_20170917232900_big.jpg"</span>)</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/13/网络编程笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cedar Chen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/13/网络编程笔记/" itemprop="url">网络编程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-13T20:20:27+08:00">
                2019-03-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><p><strong> IP地址 </strong>:用来在网络中标记一台电脑,比如192.168.1.1在本地局域网是唯一的<br>在Linux中查看IP地址 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig </span><br></pre></td></tr></table></figure><br>每个IP地址包括两部分:网络地址和主机地址<br><strong> 端口 </strong><br>:是计算机与外界通讯交流的出口,端口号只有整数,范围是:0-65535<br><strong> 创建一个socket套接字 </strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">s = socket.socket(socket.AF_INET,socket.SOCK_DGRAM)</span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure></p>
<h1 id="udp"><a href="#udp" class="headerlink" title="udp"></a>udp</h1><h1 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h1><p><strong> 文件下载_server.py </strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_file_2_client</span><span class="params">(new_client_socket, client_addr)</span>:</span></span><br><span class="line">    <span class="comment"># 1. 接收客户端 需要下载的文件名</span></span><br><span class="line">    <span class="comment"># 接收客户端发送过来的 要下载的文件名</span></span><br><span class="line">    file_name = new_client_socket.recv(<span class="number">1024</span>).decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    print(<span class="string">"客户端(%s)需要下载文件是：%s"</span> % (str(client_addr), file_name))</span><br><span class="line"></span><br><span class="line">    file_content = <span class="literal">None</span></span><br><span class="line">    <span class="comment"># 2. 打开这个文件，读取数据</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f = open(file_name, <span class="string">"rb"</span>)</span><br><span class="line">        file_content = f.read()</span><br><span class="line">        f.close()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ret:</span><br><span class="line">        print(<span class="string">"没有要下载的文件(%s)"</span> % file_name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 发送文件的数据给客户端</span></span><br><span class="line">    <span class="keyword">if</span> file_content:</span><br><span class="line">        <span class="comment"># new_client_socket.send("hahahghai-----ok-----".encode("utf-8"))</span></span><br><span class="line">        new_client_socket.send(file_content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 1. 买个手机(创建套接字 socket)</span></span><br><span class="line">    tcp_server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 插入手机卡(绑定本地信息 bind)</span></span><br><span class="line">    tcp_server_socket.bind((<span class="string">""</span>, <span class="number">7890</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 将手机设置为正常的 响铃模式(让默认的套接字由主动变为被动 listen)</span></span><br><span class="line">    tcp_server_socket.listen(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># 4. 等待别人的电话到来(等待客户端的链接 accept)</span></span><br><span class="line">        new_client_socket, client_addr = tcp_server_socket.accept()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5. 调用发送文件函数，完成为客户端服务</span></span><br><span class="line">        send_file_2_client(new_client_socket, client_addr)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 6. 关闭套接字</span></span><br><span class="line">        new_client_socket.close()</span><br><span class="line">    tcp_server_socket.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p>
<p><strong> 文件下载_client.py </strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    # 1. 创建套接字</span><br><span class="line">    tcp_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line">    # 2. 获取服务器的ip port</span><br><span class="line">    dest_ip = input(&quot;请输入下载服务器的ip:&quot;)</span><br><span class="line">    dest_port = int(input(&quot;请输入下载服务器的port:&quot;))</span><br><span class="line"></span><br><span class="line">    # 3. 链接服务器</span><br><span class="line">    tcp_socket.connect((dest_ip, dest_port))</span><br><span class="line"></span><br><span class="line">    # 4. 获取下载的文件名字</span><br><span class="line">    download_file_name = input(&quot;请输入要下载的文件名字：&quot;)</span><br><span class="line"></span><br><span class="line">    # 5. 将文件名字发送到服务器</span><br><span class="line">    tcp_socket.send(download_file_name.encode(&quot;utf-8&quot;))</span><br><span class="line"></span><br><span class="line">    # 6. 接收文件中的数据</span><br><span class="line">    recv_data = tcp_socket.recv(1024)  # 1024---&gt;1K  1024*1024---&gt;1k*1024=1M 1024*1024*124---&gt;1G</span><br><span class="line"></span><br><span class="line">    if recv_data:</span><br><span class="line">        # 7. 保存接收到的数据到一个文件中</span><br><span class="line">        with open(&quot;[新]&quot; + download_file_name, &quot;wb&quot;) as f:</span><br><span class="line">            f.write(recv_data)</span><br><span class="line"></span><br><span class="line">    # 8. 关闭套接字</span><br><span class="line">    tcp_socket.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/09/Hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cedar Chen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/09/Hexo/" itemprop="url">Hexo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-09T16:22:13+08:00">
                2019-03-09
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learn/" itemprop="url" rel="index">
                    <span itemprop="name">learn</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="安装-Hexo-完成后，请执行下列命令，Hexo-将会在指定文件夹中新建所需要的文件。"><a href="#安装-Hexo-完成后，请执行下列命令，Hexo-将会在指定文件夹中新建所需要的文件。" class="headerlink" title="安装 Hexo 完成后，请执行下列命令，Hexo 将会在指定文件夹中新建所需要的文件。"></a>安装 Hexo 完成后，请执行下列命令，Hexo 将会在指定文件夹中新建所需要的文件。</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init &lt;folder&gt;</span><br><span class="line">$ cd &lt;folder&gt;</span><br><span class="line">$ npm install</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexp</a></p>
<h3 id="https-github-com-CedarChennn-CedarChennn-github-io-git"><a href="#https-github-com-CedarChennn-CedarChennn-github-io-git" class="headerlink" title="https://github.com/CedarChennn/CedarChennn.github.io.git"></a><a href="https://github.com/CedarChennn/CedarChennn.github.io.git" target="_blank" rel="noopener">https://github.com/CedarChennn/CedarChennn.github.io.git</a></h3><p>$ hexo -g  #在修改配置文件后需要重新执执行此命令创建生成静态文件,之后部署网站修改的配置文件才会生效<br>$ hexo clean  #清除缓存文件 (db.json) 和已生成的静态文件 (public)。<br> <img src="/images/alipay.jpg"><br> hexo写作的教程:<a href="https://hexo.io/zh-cn/docs/writing" target="_blank" rel="noopener">https://hexo.io/zh-cn/docs/writing</a><br>nexT使用教程:<a href="https://theme-next.iissnan.com/getting-started.html" target="_blank" rel="noopener">https://theme-next.iissnan.com/getting-started.html</a><br>hexo clean :清除 Hexo 的缓存。<br><a href="https://github.com/CedarChennn/CedarChennn.github.io.git" target="_blank" rel="noopener">https://github.com/CedarChennn/CedarChennn.github.io.git</a></p>
<p>hexo init<br>npm install</p>
<p>deploy:<br>  type: git<br>  repo: <a href="https://github.com/CedarChennn/CedarChennn.github.io.git" target="_blank" rel="noopener">https://github.com/CedarChennn/CedarChennn.github.io.git</a><br>  branch: master</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/08/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cedar Chen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/08/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-08T16:22:13+08:00">
                2019-03-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Cedar Chen</p>
              <p class="site-description motion-element" itemprop="description">always belive that something wonderful is about to happen</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/cedarchennn" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/CedarChennn" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-globe"></i>Twitter</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Cedar Chen</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
